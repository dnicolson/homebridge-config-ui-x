<div class="modal-content">
  <div class="modal-header">
    <h5 class="modal-title" [innerText]="service.customName || service.serviceName"></h5>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="modal"
      [attr.aria-label]="'form.button_close' | translate"
      (click)="$activeModal.dismiss('Dismiss')"
    ></button>
  </div>
  <div class="modal-body text-center">
    <div
      class="humidity-drop mb-3"
      [ngClass]="{
        'dehumidifying': service.values.CurrentHumidifierDehumidifierState === 3 && service.values.Active === 1,
        'humidifying': service.values.CurrentHumidifierDehumidifierState === 2 && service.values.Active === 1,
        'no-current-state': service.values.CurrentHumidifierDehumidifierState === 1 && service.values.Active === 1
      }"
    >
      <div class="humidity-drop-text" [innerText]="(service.values.CurrentRelativeHumidity) + '%'"></div>
    </div>

    <div
      class="btn-group-vertical d-flex justify-content-center mb-4 p-0"
      role="group"
      aria-label="Humidifier Dehumidifier Mode Control"
    >
      <button
        type="button"
        class="btn mb-0 mx-0 px-0 py-3"
        (click)="setTargetMode(0)"
        [ngClass]="{ 'btn-primary': targetMode === 0, 'btn-elegant': targetMode !== 0 }"
      >
        {{ 'accessories.control.auto' | translate }}
      </button>
      <button
        type="button"
        class="btn mb-0 mx-0 px-0 py-3"
        (click)="setTargetMode(1)"
        [ngClass]="{ 'btn-primary': targetMode === 1, 'btn-elegant': targetMode !== 1 }"
      >
        {{ 'accessories.control.humidifying' | translate }}
      </button>
      <button
        type="button"
        class="btn mb-0 mx-0 px-0 py-3"
        (click)="setTargetMode(2)"
        [ngClass]="{ 'btn-primary': targetMode === 2, 'btn-elegant': targetMode !== 2 }"
      >
        {{ 'accessories.control.dehumidifying' | translate }}
      </button>
      <button
        type="button"
        class="btn mb-0 mx-0 px-0 py-3"
        (click)="setTargetMode('off')"
        [ngClass]="{ 'btn-primary': targetMode === 'off', 'btn-elegant': targetMode !== 'off' }"
      >
        {{ 'accessories.control.off' | translate }}
      </button>
    </div>

    @if (service.values.Active === 1 && RelativeHumidityHumidifierThreshold && RelativeHumidityDehumidifierThreshold) {
    <h5>{{ 'accessories.control.target_humidity' | translate }}</h5>
    @switch (targetMode) { @case (0) {
    <p>{{ autoHumidity[0] }}% - {{ autoHumidity[1] }}%</p>
    <nouislider
      [min]="RelativeHumidityHumidifierThreshold.minValue"
      [max]="RelativeHumidityDehumidifierThreshold.maxValue"
      [step]="RelativeHumidityDehumidifierThreshold.minStep"
      [(ngModel)]="autoHumidity"
      (ngModelChange)="onHumidityStateChange()"
    >
    </nouislider>
    } @case (1) {
    <p>{{ targetHumidifierHumidity }}%</p>
    <nouislider
      [min]="RelativeHumidityHumidifierThreshold.minValue"
      [max]="RelativeHumidityHumidifierThreshold.maxValue"
      [step]="RelativeHumidityHumidifierThreshold.minStep"
      [(ngModel)]="targetHumidifierHumidity"
      (ngModelChange)="onHumidityStateChange()"
    >
    </nouislider>
    } @case (2) {
    <p>{{ targetDehumidifierHumidity }}%</p>
    <nouislider
      [min]="RelativeHumidityDehumidifierThreshold.minValue"
      [max]="RelativeHumidityDehumidifierThreshold.maxValue"
      [step]="RelativeHumidityDehumidifierThreshold.minStep"
      [(ngModel)]="targetDehumidifierHumidity"
      (ngModelChange)="onHumidityStateChange()"
    >
    </nouislider>
    } } }
  </div>
  <div class="modal-footer"></div>
</div>
